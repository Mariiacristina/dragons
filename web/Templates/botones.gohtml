<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<title>Botones</title>
	<script src = "https://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>
	<style>
        li {
            display: inline;
        }

		div {
			display:inline-block;
		}

        /* Style the navigation bar */
        .navbar {
        width: 100%;
        background-color: #555;
        overflow: auto;
        }

        /* Navbar links */
        .navbar a {
        float: left;
        text-align: center;
        padding: 12px;
        color: white;
        text-decoration: none;
        font-size: 17px;
        }

        /* Navbar links on mouse-over */
        .navbar a:hover {
        background-color: #000;
        }

        /* Current/active navbar link */
        .active {
        background-color: #4CAF50;
        }

        /* Add responsiveness - will automatically display the navbar vertically instead of horizontally on screens less than 500 pixels */
        @media screen and (max-width: 500px) {
        .navbar a {
            float: none;
            display: block;
        }
        }
        .emergencia{
            background-color: #00b300;
            height:100px;
            padding: 20px 20px;
            border: solid;
			border-color: #3333ff;
        }
		.emergencia1{
            background-color: #00b300;
            height:100px;
            padding: 20px 20px;
            border: solid;
			border-color: #3333ff;
        }
        .bo{
			background-color: #ccffcc;
			text-align:center;
			padding: 25px;
			position: relative;
		}
		.desplazada-left {
			float: left;
			padding: 25px;
		}
		.desplazada-right {
			float: right;
			padding: 25px;
		}
	 </style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="bo" onload="CargarBotones()">

	

	<div class="navbar">
		<a class="active" href="http://localhost:8080/panel"><i class="fa fa-fw fa-linux"></i> Home</a> 
		<a href="http://localhost:8080/panel"><i class="fa fa-fw fa-hand-rock-o"></i> Panel Principal</a> 
		<a href="http://localhost:8080/perfil"><i class="fa fa-fw fa-code-fork"></i> Perfil de Comfiguraci√≥n</a> 
		<a href="http://localhost:8080/botones"><i class="fa fa-fw fa-bullseye"></i> Botones de Emergencia</a>
        <a href="http://localhost:8080/"><i class="fa fa-fw fa-sign-out"></i> Logout</a>
	</div>
	


	<h1>BOTONES DE EMERGENCIA</h2>
    <div>
		<br><br>
		<div class = "desplazada-left">

        <h2>GESTIONAR PLACA</h2>
		<button class="emergencia" type="submit" id="apagarplaca" value="placa">
			  <h3>GESTIONAR PLACA </h3> 
		</button>

    
		<h2>GESTIONAR BOMBILLO </h2>
		<br><br>
		<button class="emergencia1" type="submit" id="apagarbombillo" value="bombillo">
	    <h3>GESTIONAR BOMBILLO </h3> 
		</button>
		</div>
		
		<div class="desplazada-right">
		<h2>GESTIONAR CASCADA </h2>
		<button class="emergencia1" type="submit" id="apagarcascada" value="cascada">
        <h3>GESTIONAR CASCADA </h3> 
		</button>

        <br>
		<h2>GESTIONAR UV </h2>
		<br><br>
		<button class="emergencia1" type="submit" id="apagaruv" value="uv">
            <h3>GESTIONAR UV </h3> 
		</button>
		</div>
	</div>
</body>

	<script>

		function CargarBotones(){
			$.ajax({
				url: 'http://localhost:8000/botones/',
				contentType:"application/json; charset: utf-8",
				crossDomain: true,
				withCredentials:false,
				type: 'GET',
				success: function (res){
					console.log("Apagar o encender equipos")
					console.log(res.placa)
					var plac = res.placa
					console.log(plac)
					if (res.placa == 'true') {
						//alert("Placa esta Apagado y se debe encender, ok");
						localStorage.setItem('estadoplaca',res.placa);
						document.getElementById('apagarplaca').innerHTML = res.placa;
						document.getElementById("apagarplaca").style.background = "#00FF00";
						console.log(apagarplaca.value);
						console.log(localStorage.getItem('estadoplaca'));
					} else {
						//alert("Placa esta Encendido, se debe apagar");
						localStorage.setItem('estadoplaca',res.placa);
						document.getElementById('apagarplaca').innerHTML = res.placa
						document.getElementById("apagarplaca").style.background = "#ff5b5a";
					}
					if (res.bombillo == 'true') {
						//alert("Bombillo esta Apagado y se debe encender");
						localStorage.setItem('estadobombillo',res.bombillo);
						document.getElementById('apagarbombillo').innerHTML = res.bombillo
						document.getElementById("apagarbombillo").style.background = "#00FF00";
					} else {
						//alert("Bombillo esta Encendido, se debe apagar");
						localStorage.setItem('estadobombillo',res.bombillo);
						document.getElementById('apagarbombillo').innerHTML = res.bombillo
						document.getElementById("apagarbombillo").style.background = "#ff5b5a";
						console.log(localStorage.getItem('estadobombillo'));
					}
					if (res.cascada == 'true') {
						//alert("Cascada esta Apagado y se debe encender");
						localStorage.setItem('estadocascada',res.cascada);
						document.getElementById('apagarcascada').innerHTML = res.cascada
						document.getElementById("apagarcascada").style.background = "#00FF00";
						console.log(localStorage.getItem('estadocascada'));
					} else {
						//alert("Cascada esta Encendido, se debe apagar");
						localStorage.setItem('estadocascada',res.cascada);
						document.getElementById('apagarcascada').innerHTML = res.cascada
						document.getElementById("apagarcascada").style.background = "#ff5b5a";
					}
					if (res.uv == 'true') {
						//alert("Uv esta Apagado y se debe encender");
						localStorage.setItem('estadouv',res.uv);
						document.getElementById('apagaruv').innerHTML = res.uv
						document.getElementById("apagaruv").style.background = "#00FF00";
					} else {
						//alert("Uv esta Encendido, se debe apagar");
						localStorage.setItem('estadouv',res.uv);
						document.getElementById('apagaruv').innerHTML = res.uv
						document.getElementById("apagaruv").style.background = "#ff5b5a";
						console.log(localStorage.getItem('estadouv'));
					}
				},
			});
		}

		$('#apagarplaca')
		.click(function(e){
			console.log("Inicio de cambio de estado de Placa")
			//if boton de apagar placa color == verde entonces manda un ajax apagandolo, y cmo respuesta cambie el color del boton a rojo
			$.ajax({
				//data: plaka,
				url: 'http://localhost:8000/botones/placa/',
				contentType:"application/json; charset: utf-8",
				crossDomain: true,
				withCredentials:false,
				type: 'post',
				
				success: function (res){
					console.log(res.placa);
					if (res.placa == "true") {
						alert("Placa esta encendida y se apaga");
						document.getElementById('apagarplaca').innerHTML = res.placa;
						document.getElementById("apagarplaca").style.background = "#00FF00";  //verde
						localStorage.setItem('estadoplaca',res.placa);
					} 
					else {
						alert("Placa esta Apagada y se enciende");
						document.getElementById('apagarplaca').innerHTML = res.placa
						document.getElementById("apagarplaca").style.background = "#ff5b5a";    //rojo
						localStorage.setItem('estadoplaca',res.placa);
					}
					
					},
				error: function(){
					alert("Hubo algun tipo de error.");		
					}
			});
		});

		$('#apagarbombillo')
		.click(function(e){
			console.log("Inicio de cambio de estado de Bombillo")
			$.ajax({
				url: 'http://localhost:8000/botones/bombillo/',
				contentType:"application/json; charset: utf-8",
				crossDomain: true,
				withCredentials:false,
				type: 'post',
				beforeSend: function(){
					window.alert("Procesando, espere porfavor...");
				},
				success: function (res){
					console.log(res.bombillo);
					if (res.bombillo == "true") {
						alert("bombillo esta encendida y se apaga");
						document.getElementById('apagarbombillo').innerHTML = res.bombillo;
						document.getElementById("apagarbombillo").style.background = "#00FF00";  //verde
						localStorage.setItem('estadobombillo',res.bombillo);
					}	else {		alert("bombillo esta Apagada y se enciende");
						document.getElementById('apagarbombillo').innerHTML = res.bombillo
						document.getElementById("apagarbombillo").style.background = "#ff5b5a";    //rojo
						localStorage.setItem('estadobombillo',res.bombillo);
					}
					
					},
				error: function(){
					alert("Hubo algun tipo de error.");		
					}
			});
		});


		$('#apagarcascada')
		.click(function(e){
			console.log("Inicio de cambio de estado de Cascada")
			$.ajax({
				url: 'http://localhost:8000/botones/cascada/',
				contentType:"application/json; charset: utf-8",
				crossDomain: true,
				withCredentials:false,
				type: 'post',
				beforeSend: function(){
					window.alert("Procesando, espere porfavor...");
				},
				success: function (res){
					console.log(res.cascada);
					if (res.cascada == "true") {
						alert("cascada esta encendida y se apaga");
						document.getElementById('apagarcascada').innerHTML = res.cascada;
						document.getElementById("apagarcascada").style.background = "#00FF00";  //verde
						localStorage.setItem('estadocascada',res.cascada);
					}	else {		alert("cascada esta Apagada y se enciende");
						document.getElementById('apagarcascada').innerHTML = res.cascada
						document.getElementById("apagarcascada").style.background = "#ff5b5a";    //rojo
						localStorage.setItem('estadocascada',res.cascada);
					}
					
					},
				error: function(){
					alert("Hubo algun tipo de error.");		
					}
			});
		});

		$('#apagaruv')
		.click(function(e){
			console.log("Inicio de cambio de estado de Uv")
			$.ajax({
				url: 'http://localhost:8000/botones/uv/',
				contentType:"application/json; charset: utf-8",
				crossDomain: true,
				withCredentials:false,
				type: 'post',
				beforeSend: function(){
					window.alert("Procesando, espere porfavor...");
				},
				success: function (res){
					console.log(res.uv);
					if (res.uv == "true") {
						alert("uv esta encendida y se apaga");
						document.getElementById('apagaruv').innerHTML = res.uv;
						document.getElementById("apagaruv").style.background = "#00FF00";  //verde
						localStorage.setItem('estadouv',res.uv);
					}	else {		alert("uv esta Apagada y se enciende");
						document.getElementById('apagaruv').innerHTML = res.uv
						document.getElementById("apagaruv").style.background = "#ff5b5a";    //rojo
						localStorage.setItem('estadouv',res.uv);
					}
					
					},
				error: function(){
					alert("Hubo algun tipo de error.");		
					}
			});
		});

	</script>
</html>
